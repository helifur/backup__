!function(){"use strict";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var e={exports:{}};"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,function(e){if("undefined"==typeof browser||Object.getPrototypeOf(browser)!==Object.prototype){const a="The message port closed before a response was received.",s=e=>{const s={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(s).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,a){super(a),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const n=e=>e&&"object"==typeof e&&"function"==typeof e.then,t=(a,s)=>(...r)=>{e.runtime.lastError?a.reject(new Error(e.runtime.lastError.message)):s.singleCallbackArg||r.length<=1&&!1!==s.singleCallbackArg?a.resolve(r[0]):a.resolve(r)},i=e=>1==e?"argument":"arguments",g=(e,a)=>function(s,...r){if(r.length<a.minArgs)throw new Error(`Expected at least ${a.minArgs} ${i(a.minArgs)} for ${e}(), got ${r.length}`);if(r.length>a.maxArgs)throw new Error(`Expected at most ${a.maxArgs} ${i(a.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((n,i)=>{if(a.fallbackToNoCallback)try{s[e](...r,t({resolve:n,reject:i},a))}catch(t){s[e](...r),a.fallbackToNoCallback=!1,a.noCallback=!0,n()}else a.noCallback?(s[e](...r),n()):s[e](...r,t({resolve:n,reject:i},a))}))},o=(e,a,s)=>new Proxy(a,{apply:(a,r,n)=>s.call(r,e,...n)});let m=Function.call.bind(Object.prototype.hasOwnProperty);const l=(e,a={},s={})=>{let r=Object.create(null),n={has:(a,s)=>s in e||s in r,get(n,t,i){if(t in r)return r[t];if(!(t in e))return;let A=e[t];if("function"==typeof A)if("function"==typeof a[t])A=o(e,e[t],a[t]);else if(m(s,t)){let a=g(t,s[t]);A=o(e,e[t],a)}else A=A.bind(e);else if("object"==typeof A&&null!==A&&(m(a,t)||m(s,t)))A=l(A,a[t],s[t]);else{if(!m(s,"*"))return Object.defineProperty(r,t,{configurable:!0,enumerable:!0,get:()=>e[t],set(a){e[t]=a}}),A;A=l(A,a[t],s["*"])}return r[t]=A,A},set:(a,s,n,t)=>(s in r?r[s]=n:e[s]=n,!0),defineProperty:(e,a,s)=>Reflect.defineProperty(r,a,s),deleteProperty:(e,a)=>Reflect.deleteProperty(r,a)},t=Object.create(e);return new Proxy(t,n)},A=e=>({addListener(a,s,...r){a.addListener(e.get(s),...r)},hasListener:(a,s)=>a.hasListener(e.get(s)),removeListener(a,s){a.removeListener(e.get(s))}}),c=new r((e=>"function"!=typeof e?e:function(a){const s=l(a,{},{getContent:{minArgs:0,maxArgs:0}});e(s)}));let u=!1;const d=new r((e=>"function"!=typeof e?e:function(a,s,r){let t,i,g=!1,o=new Promise((e=>{t=function(a){u||(u=!0),g=!0,e(a)}}));try{i=e(a,s,t)}catch(e){i=Promise.reject(e)}const m=!0!==i&&n(i);return!(!0!==i&&!m&&!g||((m?i:o).then((e=>{r(e)}),(e=>{let a;a=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",r({__mozWebExtensionPolyfillReject__:!0,message:a})})).catch((e=>{})),0))})),x=({reject:s,resolve:r},n)=>{e.runtime.lastError?e.runtime.lastError.message===a?r():s(new Error(e.runtime.lastError.message)):n&&n.__mozWebExtensionPolyfillReject__?s(new Error(n.message)):r(n)},h=(e,a,s,...r)=>{if(r.length<a.minArgs)throw new Error(`Expected at least ${a.minArgs} ${i(a.minArgs)} for ${e}(), got ${r.length}`);if(r.length>a.maxArgs)throw new Error(`Expected at most ${a.maxArgs} ${i(a.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((e,a)=>{const n=x.bind(null,{resolve:e,reject:a});r.push(n),s.sendMessage(...r)}))},f={devtools:{network:{onRequestFinished:A(c)}},runtime:{onMessage:A(d),onMessageExternal:A(d),sendMessage:h.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:h.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},p={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return s.privacy={network:{"*":p},services:{"*":p},websites:{"*":p}},l(e,f,s)};if("object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");e.exports=s(chrome)}else e.exports=browser}(e);const a=new Map([["af","Afrikaans"],["sq","Albanian"],["am","Amharic"],["ar","Arabic"],["hy","Armenian"],["az","Azerbaijani"],["eu","Basque"],["be","Belarusian"],["bn","Bengali"],["bs","Bosnian"],["bg","Bulgarian"],["ca","Catalan"],["ceb","Cebuano"],["ny","Chichewa"],["zh-CN","Chinese (Simplified)"],["zh-TW","Chinese (Traditional)"],["co","Corsican"],["hr","Croatian"],["cs","Czech"],["da","Danish"],["nl","Dutch"],["en","English"],["eo","Esperanto"],["et","Estonian"],["tl","Filipino"],["fi","Finnish"],["fr","French"],["fy","Frisian"],["gl","Galician"],["ka","Georgian"],["de","German"],["el","Greek"],["gu","Gujarati"],["ht","Haitian Creole"],["ha","Hausa"],["haw","Hawaiian"],["iw","Hebrew"],["hi","Hindi"],["hmn","Hmong"],["hu","Hungarian"],["is","Icelandic"],["ig","Igbo"],["id","Indonesian"],["ga","Irish"],["it","Italian"],["ja","Japanese"],["jw","Javanese"],["kn","Kannada"],["kk","Kazakh"],["km","Khmer"],["rw","Kinyarwanda"],["ko","Korean"],["ku","Kurdish (Kurmanji)"],["ky","Kyrgyz"],["lo","Lao"],["la","Latin"],["lv","Latvian"],["lt","Lithuanian"],["lb","Luxembourgish"],["mk","Macedonian"],["mg","Malagasy"],["ms","Malay"],["ml","Malayalam"],["mt","Maltese"],["mi","Maori"],["mr","Marathi"],["mn","Mongolian"],["my","Myanmar (Burmese)"],["ne","Nepali"],["no","Norwegian"],["or","Odia (Oriya)"],["ps","Pashto"],["fa","Persian"],["pl","Polish"],["pt","Portuguese"],["pa","Punjabi"],["ro","Romanian"],["ru","Russian"],["sm","Samoan"],["gd","Scots Gaelic"],["sr","Serbian"],["st","Sesotho"],["sn","Shona"],["sd","Sindhi"],["si","Sinhala"],["sk","Slovak"],["sl","Slovenian"],["so","Somali"],["es","Spanish"],["su","Sundanese"],["sw","Swahili"],["sv","Swedish"],["tg","Tajik"],["ta","Tamil"],["tt","Tatar"],["te","Telugu"],["th","Thai"],["tr","Turkish"],["tk","Turkmen"],["uk","Ukrainian"],["ur","Urdu"],["ug","Uyghur"],["uz","Uzbek"],["vi","Vietnamese"],["cy","Welsh"],["xh","Xhosa"],["yi","Yiddish"],["yo","Yoruba"],["zu","Zulu"]]);function s(){const s=e.exports.i18n.getUILanguage();if(a.has(s))return s;const r=s.substring(0,2);return a.has(r)?r:"en"}function r(){return[...a.entries()]}const n=[{id:"general",name:"General",children:[{id:"target_language",type:"select",label:"Target language",defaultValue:s(),options:r(),description:"Language used to all translations"},{id:"second_language",type:"select",label:"Second language",defaultValue:"es"===s()?"en":"es",options:r(),description:"Language used if the input is same as the target language"},{id:"theme",type:"select",label:"Theme",defaultValue:"system",options:["light","dark","system"]}]},{id:"toolbar_translation",name:"Toolbar translation",children:[{id:"toolbar_delay",type:"number",label:"Waiting time to translate",defaultValue:500,min:0,description:"Time to wait before translating the text (in milliseconds)"}]},{id:"floating",name:"Floating translation",children:[{id:"floating_enabled",type:"boolean",label:"Enabled",defaultValue:!0},{id:"floating_omit_main",type:"boolean",label:"Omit in target language",description:"Ignore pages with same language as target language",defaultValue:!0},{id:"floating_position",type:"select",label:"Position",defaultValue:"bottom",options:["top","bottom","left","right"]},{id:"floating_max_width",type:"number",label:"Max Width (px)",description:'Set to "0" to disable',defaultValue:300,min:0},{id:"floating_max_height",type:"number",label:"Max Height (px)",description:'Set to "0" to disable',defaultValue:300,min:0}]},{id:"context_menu",name:"Context menu",children:[{id:"context_enabled",type:"boolean",label:"Enabled",description:"If enabled, you will see in the context menu an option to translate the current page",defaultValue:!0}]}];async function t(){return(await e.exports.storage.local.get({settings:{}})).settings}async function i(e){return(await t())[e]}async function g(){const a=await t();let s=!1;n.forEach((e=>{e.children.forEach((e=>{const{id:r,defaultValue:n}=e;Object.hasOwn(a,r)||(s=!0,a[r]=n)}))})),s&&await async function(a){await e.exports.storage.local.set({settings:a})}(a)}const o="context_enabled";function m(){async function a(a,s){const r=encodeURIComponent(a.pageUrl),n=await async function(a){const s={from:await e.exports.tabs.detectLanguage(a.id),to:await i("target_language")};return s.to===s.from&&(s.to=await i("second_language")),s}(s),t=`https://translate.google.com/translate?hl=${n.to}&tl=${n.to}&sl=${n.from}&u=${r}`;e.exports.tabs.create({url:t,index:s.index+1,active:!0})}e.exports.contextMenus.create({id:o,title:"Translate page"}),e.exports.contextMenus.onClicked.addListener(((e,s)=>{e.menuItemId===o&&s&&a(e,s)}))}function l(){i(o).then((e=>e&&m())),async function(a,s){e.exports.storage.onChanged.addListener((({settings:e={}})=>{e.newValue[a]!==e.oldValue[a]&&s(e.newValue[a])}))}(o,(a=>a?m():function(a){return e.exports.contextMenus.remove(a)}(o)))}async function A({from:e,text:a,to:s}){var r;const n=`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${e}&tl=${s}&dt=t&dt=bd&dj=1&q=${encodeURIComponent(a)}`,t=await(await fetch(n)).json();return{text:t.sentences.reduce(((e,a)=>e+a.trans),""),dict:t.dict,srcLang:(null==(r=t.ld_result)?void 0:r.srclangs[0])||t.src,outLang:s}}async function c({text:e,lang:a}){return async function(e,a){const s=[];for(let r=0;r<e.length;r++){const n=`https://translate.google.com/translate_tts?ie=UTF-8&q=${encodeURIComponent(e[r])}&tl=${a}&total=1&idx=0&textlen=${e[r].length}&client=tw-ob`,t=await(await fetch(n)).blob(),i=await u(t);s.push(i)}return s}(function(e){let a="",s=[];if(e.length>200){const r=e.match(/.*?[\.\s]+?/g);for(let e=0;e<r.length;e++)a.length+r[e].length<200?a+=r[e]:(s.push(a),a="");a.length&&s.push(a)}else s.push(e);return s}(e),a)}function u(e){return new Promise((a=>{const s=new FileReader;s.onload=()=>{a(s.result)},s.readAsDataURL(e)}))}chrome.runtime.onInstalled.addListener((function(e){"install"===e.reason&&chrome.tabs.create({url:"https://quickwebtranslate.com/api/install"})})),chrome.runtime.setUninstallURL("https://quickwebtranslate.com/uninstall/"),e.exports.runtime.onInstalled.addListener((async()=>{await g(),l()})),e.exports.runtime.onMessage.addListener((async({type:e,data:a})=>{switch(e){case"translate":return await async function({text:e,from:a,to:s,alternative:r}){let n=await A({text:e,from:a,to:s});return n.srcLang===s&&r&&(n=await A({text:e,from:a,to:r})),n}(a);case"getAudioUrl":return await c(a)}}))}();